<!DOCTYPE html>
<html lang="english">
<head>
        <meta charset="utf-8" />
        <title>Csv in Python</title>
        <link rel="stylesheet" href="/theme/css/main.css" />

        <!--[if IE]>
            <script src="https://html5shiv.googlecode.com/svn/trunk/html5.js"></script>
        <![endif]-->
</head>

<body id="index" class="home">
        <header id="banner" class="body">
                <h1><a href="/">Data Analytics-Akanksha Goel </a></h1>
                <nav><ul>
                    <li class="active"><a href="/category/data-analysis.html">Data Analysis</a></li>
                    <li><a href="/category/data-visualization.html">Data Visualization</a></li>
                    <li><a href="/category/data-wrangling.html">Data Wrangling</a></li>
                    <li><a href="/category/machine-learning.html">Machine Learning</a></li>
                </ul></nav>
        </header><!-- /#banner -->
<section id="content" class="body">
  <article>
    <header>
      <h1 class="entry-title">
        <a href="/csv-in-python.html" rel="bookmark"
           title="Permalink to Csv in Python">Csv in Python</a></h1>
    </header>

    <div class="entry-content">
<footer class="post-info">
        <abbr class="published" title="2017-06-03T01:20:00+05:30">
                Published: Sat 03 June 2017
        </abbr>

        <address class="vcard author">
                By                         <a class="url fn" href="/author/akanksha-goel.html">Akanksha Goel</a>
        </address>
<p>In <a href="/category/data-analysis.html">Data Analysis</a>.</p>

</footer><!-- /.post-info -->      <h2>Load Data from CSVs</h2>
<div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="kn">as</span> <span class="nn">pd</span>
</pre></div>


<div class="highlight"><pre><span></span><span class="n">daily_engagement</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;daily_engagement_full.csv&#39;</span><span class="p">)</span>
</pre></div>


<div class="highlight"><pre><span></span><span class="nb">len</span><span class="p">(</span><span class="n">daily_engagement</span><span class="p">[</span><span class="s1">&#39;acct&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">())</span>
</pre></div>


<div class="highlight"><pre><span></span>1237
</pre></div>


<div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">unicodecsv</span>

<span class="c1">## Longer version of code (replaced with shorter, equivalent version below)</span>

<span class="c1"># enrollments = []</span>
<span class="c1"># f = open(&#39;enrollments.csv&#39;, &#39;rb&#39;)</span>
<span class="c1"># reader = unicodecsv.DictReader(f)</span>
<span class="c1"># for row in reader:</span>
<span class="c1">#     enrollments.append(row)</span>
<span class="c1"># f.close()</span>
<span class="k">def</span> <span class="nf">save_file</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="s1">&#39;rb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="n">reader</span> <span class="o">=</span> <span class="n">unicodecsv</span><span class="o">.</span><span class="n">DictReader</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
        <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="n">reader</span><span class="p">)</span>
</pre></div>


<div class="highlight"><pre><span></span><span class="c1">#####################################</span>
<span class="c1">#                 1                 #</span>
<span class="c1">#####################################</span>

<span class="c1">## Read in the data from daily_engagement.csv and project_submissions.csv </span>
<span class="c1">## and store the results in the below variables.</span>
<span class="c1">## Then look at the first row of each table.</span>
<span class="n">enrollments</span> <span class="o">=</span> <span class="n">save_file</span><span class="p">(</span><span class="s1">&#39;enrollments.csv&#39;</span><span class="p">)</span>
<span class="n">daily_engagement</span> <span class="o">=</span> <span class="n">save_file</span><span class="p">(</span><span class="s1">&#39;daily_engagement.csv&#39;</span><span class="p">)</span>
<span class="n">project_submissions</span> <span class="o">=</span>  <span class="n">save_file</span><span class="p">(</span><span class="s1">&#39;project_submissions.csv&#39;</span><span class="p">)</span>

<span class="k">print</span> <span class="n">daily_engagement</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>


<div class="highlight"><pre><span></span>{u&#39;lessons_completed&#39;: u&#39;0.0&#39;, u&#39;num_courses_visited&#39;: u&#39;1.0&#39;, u&#39;total_minutes_visited&#39;: u&#39;11.6793745&#39;, u&#39;projects_completed&#39;: u&#39;0.0&#39;, u&#39;acct&#39;: u&#39;0&#39;, u&#39;utc_date&#39;: u&#39;2015-01-09&#39;}
</pre></div>


<h2>Fixing Data Types</h2>
<div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">datetime</span> <span class="kn">import</span> <span class="n">datetime</span> <span class="k">as</span> <span class="n">dt</span>

<span class="c1"># Takes a date as a string, and returns a Python datetime object. </span>
<span class="c1"># If there is no date given, returns None</span>
<span class="k">def</span> <span class="nf">parse_date</span><span class="p">(</span><span class="n">date</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">date</span> <span class="o">==</span> <span class="s1">&#39;&#39;</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">None</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">dt</span><span class="o">.</span><span class="n">strptime</span><span class="p">(</span><span class="n">date</span><span class="p">,</span> <span class="s1">&#39;%Y-%m-</span><span class="si">%d</span><span class="s1">&#39;</span><span class="p">)</span>

<span class="c1"># Takes a string which is either an empty string or represents an integer,</span>
<span class="c1"># and returns an int or None.</span>
<span class="k">def</span> <span class="nf">parse_maybe_int</span><span class="p">(</span><span class="n">i</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="s1">&#39;&#39;</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">None</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="nb">int</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>

<span class="c1"># Clean up the data types in the enrollments table</span>
<span class="k">for</span> <span class="n">enrollment</span> <span class="ow">in</span> <span class="n">enrollments</span><span class="p">:</span>
    <span class="n">enrollment</span><span class="p">[</span><span class="s1">&#39;cancel_date&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">parse_date</span><span class="p">(</span><span class="n">enrollment</span><span class="p">[</span><span class="s1">&#39;cancel_date&#39;</span><span class="p">])</span>
    <span class="n">enrollment</span><span class="p">[</span><span class="s1">&#39;days_to_cancel&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">parse_maybe_int</span><span class="p">(</span><span class="n">enrollment</span><span class="p">[</span><span class="s1">&#39;days_to_cancel&#39;</span><span class="p">])</span>
    <span class="n">enrollment</span><span class="p">[</span><span class="s1">&#39;is_canceled&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">enrollment</span><span class="p">[</span><span class="s1">&#39;is_canceled&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;True&#39;</span>
    <span class="n">enrollment</span><span class="p">[</span><span class="s1">&#39;is_udacity&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">enrollment</span><span class="p">[</span><span class="s1">&#39;is_udacity&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;True&#39;</span>
    <span class="n">enrollment</span><span class="p">[</span><span class="s1">&#39;join_date&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">parse_date</span><span class="p">(</span><span class="n">enrollment</span><span class="p">[</span><span class="s1">&#39;join_date&#39;</span><span class="p">])</span>

<span class="n">enrollments</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>


<div class="highlight"><pre><span></span>{u&#39;account_key&#39;: u&#39;448&#39;,
 u&#39;cancel_date&#39;: datetime.datetime(2015, 1, 14, 0, 0),
 u&#39;days_to_cancel&#39;: 65,
 u&#39;is_canceled&#39;: True,
 u&#39;is_udacity&#39;: True,
 u&#39;join_date&#39;: datetime.datetime(2014, 11, 10, 0, 0),
 u&#39;status&#39;: u&#39;canceled&#39;}
</pre></div>


<div class="highlight"><pre><span></span><span class="c1"># Clean up the data types in the engagement table</span>
<span class="k">for</span> <span class="n">engagement_record</span> <span class="ow">in</span> <span class="n">daily_engagement</span><span class="p">:</span>
    <span class="n">engagement_record</span><span class="p">[</span><span class="s1">&#39;lessons_completed&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">engagement_record</span><span class="p">[</span><span class="s1">&#39;lessons_completed&#39;</span><span class="p">]))</span>
    <span class="n">engagement_record</span><span class="p">[</span><span class="s1">&#39;num_courses_visited&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">engagement_record</span><span class="p">[</span><span class="s1">&#39;num_courses_visited&#39;</span><span class="p">]))</span>
    <span class="n">engagement_record</span><span class="p">[</span><span class="s1">&#39;projects_completed&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">engagement_record</span><span class="p">[</span><span class="s1">&#39;projects_completed&#39;</span><span class="p">]))</span>
    <span class="n">engagement_record</span><span class="p">[</span><span class="s1">&#39;total_minutes_visited&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">engagement_record</span><span class="p">[</span><span class="s1">&#39;total_minutes_visited&#39;</span><span class="p">])</span>
    <span class="n">engagement_record</span><span class="p">[</span><span class="s1">&#39;utc_date&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">parse_date</span><span class="p">(</span><span class="n">engagement_record</span><span class="p">[</span><span class="s1">&#39;utc_date&#39;</span><span class="p">])</span>

<span class="n">daily_engagement</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>


<div class="highlight"><pre><span></span>{u&#39;acct&#39;: u&#39;0&#39;,
 u&#39;lessons_completed&#39;: 0,
 u&#39;num_courses_visited&#39;: 1,
 u&#39;projects_completed&#39;: 0,
 u&#39;total_minutes_visited&#39;: 11.6793745,
 u&#39;utc_date&#39;: datetime.datetime(2015, 1, 9, 0, 0)}
</pre></div>


<div class="highlight"><pre><span></span><span class="c1"># Clean up the data types in the submissions table</span>
<span class="k">for</span> <span class="n">submission</span> <span class="ow">in</span> <span class="n">project_submissions</span><span class="p">:</span>
    <span class="n">submission</span><span class="p">[</span><span class="s1">&#39;completion_date&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">parse_date</span><span class="p">(</span><span class="n">submission</span><span class="p">[</span><span class="s1">&#39;completion_date&#39;</span><span class="p">])</span>
    <span class="n">submission</span><span class="p">[</span><span class="s1">&#39;creation_date&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">parse_date</span><span class="p">(</span><span class="n">submission</span><span class="p">[</span><span class="s1">&#39;creation_date&#39;</span><span class="p">])</span>

<span class="n">project_submissions</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>


<div class="highlight"><pre><span></span>{u&#39;account_key&#39;: u&#39;256&#39;,
 u&#39;assigned_rating&#39;: u&#39;UNGRADED&#39;,
 u&#39;completion_date&#39;: datetime.datetime(2015, 1, 16, 0, 0),
 u&#39;creation_date&#39;: datetime.datetime(2015, 1, 14, 0, 0),
 u&#39;lesson_key&#39;: u&#39;3176718735&#39;,
 u&#39;processing_state&#39;: u&#39;EVALUATED&#39;}
</pre></div>


<p>Note when running the above cells that we are actively changing the contents of our data variables. If you try to run these cells multiple times in the same session, an error will occur.</p>
<h2>Investigating the Data</h2>
<div class="highlight"><pre><span></span><span class="c1">#####################################</span>
<span class="c1">#                 2                 #</span>
<span class="c1">#####################################</span>

<span class="c1">## Find the total number of rows and the number of unique students (account keys)</span>
<span class="c1">## in each table.</span>
<span class="n">unique_enrolled_students</span><span class="o">=</span><span class="nb">set</span><span class="p">()</span>
<span class="k">for</span> <span class="n">enrollment</span> <span class="ow">in</span> <span class="n">enrollments</span><span class="p">:</span>
    <span class="k">if</span> <span class="n">enrollment</span><span class="p">[</span><span class="s1">&#39;account_key&#39;</span><span class="p">]</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">unique_enrolled_students</span><span class="p">:</span>
         <span class="n">unique_enrolled_students</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">enrollment</span><span class="p">[</span><span class="s1">&#39;account_key&#39;</span><span class="p">])</span>
<span class="k">print</span> <span class="nb">len</span><span class="p">(</span><span class="n">unique_enrolled_students</span><span class="p">)</span>    
<span class="k">print</span> <span class="nb">len</span><span class="p">(</span><span class="n">enrollments</span><span class="p">)</span>
<span class="n">unique_engaged_students</span><span class="o">=</span><span class="nb">set</span><span class="p">()</span>
<span class="k">for</span> <span class="n">enrollment</span> <span class="ow">in</span> <span class="n">daily_engagement</span><span class="p">:</span>
    <span class="k">if</span> <span class="n">enrollment</span><span class="p">[</span><span class="s1">&#39;acct&#39;</span><span class="p">]</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">unique_engaged_students</span><span class="p">:</span>
         <span class="n">unique_engaged_students</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">enrollment</span><span class="p">[</span><span class="s1">&#39;acct&#39;</span><span class="p">])</span>
<span class="k">print</span> <span class="nb">len</span><span class="p">(</span><span class="n">unique_engaged_students</span><span class="p">)</span>

<span class="k">print</span> <span class="nb">len</span><span class="p">(</span><span class="n">daily_engagement</span><span class="p">)</span>
<span class="c1"># project_students=set()</span>
<span class="c1"># for project_submissions[&#39;account_key&#39;] not in project_students:</span>
<span class="c1">#     project_students[]=project_submissions[&#39;account_key&#39;]</span>
<span class="c1"># len(project_students)</span>
<span class="c1"># len(project_submissions)</span>
</pre></div>


<div class="highlight"><pre><span></span>1302
1640
1237
136240
</pre></div>


<h2>Problems in the Data</h2>
<div class="highlight"><pre><span></span><span class="c1">#####################################</span>
<span class="c1">#                 3                 #</span>
<span class="c1">#####################################</span>

<span class="c1"># Rename the &quot;acct&quot; column in the daily_engagement table to &quot;account_key&quot;.</span>
<span class="k">for</span> <span class="n">engagements</span> <span class="ow">in</span> <span class="n">daily_engagement</span><span class="p">:</span>
    <span class="n">engagements</span><span class="p">[</span><span class="s1">&#39;account_key&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">engagements</span><span class="p">[</span><span class="s1">&#39;acct&#39;</span><span class="p">]</span>
    <span class="k">del</span><span class="p">[</span><span class="n">engagements</span><span class="p">[</span><span class="s1">&#39;acct&#39;</span><span class="p">]]</span>
<span class="n">daily_engagement</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;account_key&#39;</span><span class="p">]</span>
</pre></div>


<div class="highlight"><pre><span></span>u&#39;0&#39;
</pre></div>


<h2>Missing Engagement Records</h2>
<div class="highlight"><pre><span></span><span class="c1">#####################################</span>
<span class="c1">#                 4                 #</span>
<span class="c1">#####################################</span>

<span class="c1">## Find any one student enrollments where the student is missing from the daily engagement table.</span>
<span class="c1">## Output that enrollment.</span>
<span class="k">for</span> <span class="n">enrollment</span> <span class="ow">in</span> <span class="n">enrollments</span><span class="p">:</span>
    <span class="k">if</span> <span class="n">enrollment</span><span class="p">[</span><span class="s1">&#39;account_key&#39;</span><span class="p">]</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">unique_engaged_students</span><span class="p">:</span>
        <span class="k">print</span> <span class="n">enrollment</span>
        <span class="k">break</span>
</pre></div>


<div class="highlight"><pre><span></span>{u&#39;status&#39;: u&#39;canceled&#39;, u&#39;is_udacity&#39;: False, u&#39;is_canceled&#39;: True, u&#39;join_date&#39;: datetime.datetime(2014, 11, 12, 0, 0), u&#39;account_key&#39;: u&#39;1219&#39;, u&#39;cancel_date&#39;: datetime.datetime(2014, 11, 12, 0, 0), u&#39;days_to_cancel&#39;: 0}
</pre></div>


<h2>Checking for More Problem Records</h2>
<div class="highlight"><pre><span></span><span class="c1">#####################################</span>
<span class="c1">#                 5                 #</span>
<span class="c1">#####################################</span>

<span class="c1">## Find the number of surprising data points (enrollments missing from</span>
<span class="c1">## the engagement table) that remain, if any.</span>
<span class="k">for</span> <span class="n">enrollment</span> <span class="ow">in</span> <span class="n">enrollments</span><span class="p">:</span>
     <span class="k">if</span> <span class="p">(</span><span class="n">enrollment</span><span class="p">[</span><span class="s1">&#39;account_key&#39;</span><span class="p">]</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">unique_engaged_students</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">enrollment</span><span class="p">[</span><span class="s1">&#39;join_date&#39;</span><span class="p">]</span><span class="o">!=</span><span class="n">enrollment</span><span class="p">[</span><span class="s1">&#39;cancel_date&#39;</span><span class="p">])</span> <span class="p">:</span> 
            <span class="k">print</span> <span class="n">enrollment</span>
</pre></div>


<div class="highlight"><pre><span></span>{u&#39;status&#39;: u&#39;canceled&#39;, u&#39;is_udacity&#39;: True, u&#39;is_canceled&#39;: True, u&#39;join_date&#39;: datetime.datetime(2015, 1, 10, 0, 0), u&#39;account_key&#39;: u&#39;1304&#39;, u&#39;cancel_date&#39;: datetime.datetime(2015, 3, 10, 0, 0), u&#39;days_to_cancel&#39;: 59}
{u&#39;status&#39;: u&#39;canceled&#39;, u&#39;is_udacity&#39;: True, u&#39;is_canceled&#39;: True, u&#39;join_date&#39;: datetime.datetime(2015, 3, 10, 0, 0), u&#39;account_key&#39;: u&#39;1304&#39;, u&#39;cancel_date&#39;: datetime.datetime(2015, 6, 17, 0, 0), u&#39;days_to_cancel&#39;: 99}
{u&#39;status&#39;: u&#39;current&#39;, u&#39;is_udacity&#39;: True, u&#39;is_canceled&#39;: False, u&#39;join_date&#39;: datetime.datetime(2015, 2, 25, 0, 0), u&#39;account_key&#39;: u&#39;1101&#39;, u&#39;cancel_date&#39;: None, u&#39;days_to_cancel&#39;: None}
</pre></div>


<h2>Tracking Down the Remaining Problems</h2>
<div class="highlight"><pre><span></span><span class="c1"># Create a set of the account keys for all Udacity test accounts</span>
<span class="n">udacity_test_accounts</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
<span class="k">for</span> <span class="n">enrollment</span> <span class="ow">in</span> <span class="n">enrollments</span><span class="p">:</span>
    <span class="k">if</span> <span class="n">enrollment</span><span class="p">[</span><span class="s1">&#39;is_udacity&#39;</span><span class="p">]:</span>
        <span class="n">udacity_test_accounts</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">enrollment</span><span class="p">[</span><span class="s1">&#39;account_key&#39;</span><span class="p">])</span>
<span class="nb">len</span><span class="p">(</span><span class="n">udacity_test_accounts</span><span class="p">)</span>
</pre></div>


<div class="highlight"><pre><span></span>6
</pre></div>


<div class="highlight"><pre><span></span><span class="c1"># Given some data with an account_key field, removes any records corresponding to Udacity test accounts</span>
<span class="k">def</span> <span class="nf">remove_udacity_accounts</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
    <span class="n">non_udacity_data</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">data_point</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">data_point</span><span class="p">[</span><span class="s1">&#39;account_key&#39;</span><span class="p">]</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">udacity_test_accounts</span><span class="p">:</span>
            <span class="n">non_udacity_data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">data_point</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">non_udacity_data</span>
</pre></div>


<div class="highlight"><pre><span></span><span class="c1"># Remove Udacity test accounts from all three tables</span>
<span class="n">non_udacity_enrollments</span> <span class="o">=</span> <span class="n">remove_udacity_accounts</span><span class="p">(</span><span class="n">enrollments</span><span class="p">)</span>
<span class="n">non_udacity_engagement</span> <span class="o">=</span> <span class="n">remove_udacity_accounts</span><span class="p">(</span><span class="n">daily_engagement</span><span class="p">)</span>
<span class="n">non_udacity_submissions</span> <span class="o">=</span> <span class="n">remove_udacity_accounts</span><span class="p">(</span><span class="n">project_submissions</span><span class="p">)</span>

<span class="k">print</span> <span class="nb">len</span><span class="p">(</span><span class="n">non_udacity_enrollments</span><span class="p">)</span>
<span class="k">print</span> <span class="nb">len</span><span class="p">(</span><span class="n">non_udacity_engagement</span><span class="p">)</span>
<span class="k">print</span> <span class="nb">len</span><span class="p">(</span><span class="n">non_udacity_submissions</span><span class="p">)</span>
</pre></div>


<div class="highlight"><pre><span></span>1622
135656
3634
</pre></div>


<h2>Refining the Question</h2>
<div class="highlight"><pre><span></span><span class="c1">#####################################</span>
<span class="c1">#                 6                 #</span>
<span class="c1">#####################################</span>

<span class="c1">## Create a dictionary named paid_students containing all students who either</span>
<span class="c1">## haven&#39;t canceled yet or who remained enrolled for more than 7 days. The keys</span>
<span class="c1">## should be account keys, and the values should be the date the student enrolled.</span>

<span class="n">paid_students</span> <span class="o">=</span> <span class="p">{}</span>
<span class="k">for</span> <span class="n">enrollment</span> <span class="ow">in</span> <span class="n">non_udacity_enrollments</span><span class="p">:</span>
    <span class="k">if</span> <span class="p">(</span><span class="ow">not</span> <span class="n">enrollment</span><span class="p">[</span><span class="s1">&#39;is_canceled&#39;</span><span class="p">])</span> <span class="ow">or</span><span class="p">(</span> <span class="n">enrollment</span><span class="p">[</span><span class="s1">&#39;days_to_cancel&#39;</span><span class="p">]</span><span class="o">&gt;</span><span class="mi">7</span><span class="p">):</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">enrollment</span><span class="p">[</span><span class="s1">&#39;join_date&#39;</span><span class="p">]</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">paid_students</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">enrollment</span><span class="p">[</span><span class="s1">&#39;join_date&#39;</span><span class="p">]</span><span class="o">&gt;</span><span class="n">paid_student</span><span class="p">[</span><span class="n">enrollment</span><span class="p">[</span><span class="s1">&#39;account_key&#39;</span><span class="p">]]):</span>
            <span class="n">paid_students</span><span class="p">[</span><span class="n">enrollment</span><span class="p">[</span><span class="s1">&#39;account_key&#39;</span><span class="p">]]</span><span class="o">=</span><span class="p">(</span><span class="n">enrollment</span><span class="p">[</span><span class="s1">&#39;join_date&#39;</span><span class="p">])</span>
<span class="nb">len</span><span class="p">(</span><span class="n">paid_students</span><span class="p">)</span>
</pre></div>


<div class="highlight"><pre><span></span>995
</pre></div>


<h2>Getting Data from First Week</h2>
<div class="highlight"><pre><span></span><span class="c1"># Takes a student&#39;s join date and the date of a specific engagement record,</span>
<span class="c1"># and returns True if that engagement record happened within one week</span>
<span class="c1"># of the student joining.</span>
<span class="k">def</span> <span class="nf">within_one_week</span><span class="p">(</span><span class="n">join_date</span><span class="p">,</span> <span class="n">engagement_date</span><span class="p">):</span>
    <span class="n">time_delta</span> <span class="o">=</span> <span class="n">engagement_date</span> <span class="o">-</span> <span class="n">join_date</span>
    <span class="k">return</span> <span class="n">time_delta</span><span class="o">.</span><span class="n">days</span> <span class="o">&lt;</span> <span class="mi">7</span>
</pre></div>


<div class="highlight"><pre><span></span><span class="c1">#####################################</span>
<span class="c1">#                 7                 #</span>
<span class="c1">#####################################</span>

<span class="c1">## Create a list of rows from the engagement table including only rows where</span>
<span class="c1">## the student is one of the paid students you just found, and the date is within</span>
<span class="c1">## one week of the student&#39;s join date.</span>

<span class="c1"># paid_engagement_in_first_week = []</span>
<span class="c1"># for engagement in non_udacity_engagement:</span>
<span class="c1">#     if ( engagement[&#39;account_key&#39;] in paid_students) and within_one_week(paid_students[engagement[&#39;account_key&#39;]],engagement[&#39;utc_date&#39;]):</span>
<span class="c1">#         paid_engagement_in_first_week.append(engagement)</span>

<span class="c1"># len(paid_engagement_in_first_week)   </span>
<span class="k">def</span> <span class="nf">within_one_week</span><span class="p">(</span><span class="n">join_date</span><span class="p">,</span> <span class="n">engagement_date</span><span class="p">):</span>
    <span class="n">time_delta</span> <span class="o">=</span> <span class="n">engagement_date</span> <span class="o">-</span> <span class="n">join_date</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">time_delta</span><span class="o">.</span><span class="n">days</span> <span class="o">&lt;</span> <span class="mi">7</span> <span class="ow">and</span> <span class="n">time_delta</span><span class="o">.</span><span class="n">days</span><span class="o">&gt;=</span><span class="mi">0</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">remove_free_trial_cancels</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
    <span class="n">new_data</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">data_point</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">data_point</span><span class="p">[</span><span class="s1">&#39;account_key&#39;</span><span class="p">]</span> <span class="ow">in</span> <span class="n">paid_students</span><span class="p">:</span>
            <span class="n">new_data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">data_point</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">new_data</span>

<span class="n">paid_enrollments</span> <span class="o">=</span> <span class="n">remove_free_trial_cancels</span><span class="p">(</span><span class="n">non_udacity_enrollments</span><span class="p">)</span>
<span class="n">paid_engagement</span> <span class="o">=</span> <span class="n">remove_free_trial_cancels</span><span class="p">(</span><span class="n">non_udacity_engagement</span><span class="p">)</span>
<span class="n">paid_submissions</span> <span class="o">=</span> <span class="n">remove_free_trial_cancels</span><span class="p">(</span><span class="n">non_udacity_submissions</span><span class="p">)</span>

<span class="k">print</span> <span class="nb">len</span><span class="p">(</span><span class="n">paid_enrollments</span><span class="p">)</span>
<span class="k">print</span> <span class="nb">len</span><span class="p">(</span><span class="n">paid_engagement</span><span class="p">)</span>
<span class="k">print</span> <span class="nb">len</span><span class="p">(</span><span class="n">paid_submissions</span><span class="p">)</span>

<span class="n">paid_engagement_in_first_week</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">engagement_record</span> <span class="ow">in</span> <span class="n">paid_engagement</span><span class="p">:</span>
    <span class="n">account_key</span> <span class="o">=</span> <span class="n">engagement_record</span><span class="p">[</span><span class="s1">&#39;account_key&#39;</span><span class="p">]</span>
    <span class="n">join_date</span> <span class="o">=</span> <span class="n">paid_students</span><span class="p">[</span><span class="n">account_key</span><span class="p">]</span>
    <span class="n">engagement_record_date</span> <span class="o">=</span> <span class="n">engagement_record</span><span class="p">[</span><span class="s1">&#39;utc_date&#39;</span><span class="p">]</span>

    <span class="k">if</span> <span class="n">within_one_week</span><span class="p">(</span><span class="n">join_date</span><span class="p">,</span> <span class="n">engagement_record_date</span><span class="p">):</span>
         <span class="n">paid_engagement_in_first_week</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">engagement_record</span><span class="p">)</span>

<span class="nb">len</span><span class="p">(</span><span class="n">paid_engagement_in_first_week</span><span class="p">)</span>
</pre></div>


<div class="highlight"><pre><span></span>1293
134549
3618





6920
</pre></div>


<h2>Exploring Student Engagement</h2>
<div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">defaultdict</span>

<span class="c1"># Create a dictionary of engagement grouped by student.</span>
<span class="c1"># The keys are account keys, and the values are lists of engagement records.</span>
<span class="n">engagement_by_account</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">list</span><span class="p">)</span>
<span class="k">for</span> <span class="n">engagement_record</span> <span class="ow">in</span> <span class="n">paid_engagement_in_first_week</span><span class="p">:</span>
    <span class="n">account_key</span> <span class="o">=</span> <span class="n">engagement_record</span><span class="p">[</span><span class="s1">&#39;account_key&#39;</span><span class="p">]</span>
    <span class="n">engagement_by_account</span><span class="p">[</span><span class="n">account_key</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">engagement_record</span><span class="p">)</span>
<span class="c1">#engagement_by_account[&#39;426&#39;]</span>
</pre></div>


<div class="highlight"><pre><span></span><span class="c1"># Create a dictionary with the total minutes each student spent in the classroom during the first week.</span>
<span class="c1"># The keys are account keys, and the values are numbers (total minutes)</span>
<span class="n">total_minutes_by_account</span> <span class="o">=</span> <span class="p">{}</span>
<span class="n">days</span><span class="o">=</span><span class="p">{}</span>
<span class="k">for</span> <span class="n">account_key</span><span class="p">,</span> <span class="n">engagement_for_student</span> <span class="ow">in</span> <span class="n">engagement_by_account</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="n">total_minutes</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">number</span><span class="o">=</span><span class="mi">0</span>
    <span class="k">for</span> <span class="n">engagement_record</span> <span class="ow">in</span> <span class="n">engagement_for_student</span><span class="p">:</span>
        <span class="n">total_minutes</span> <span class="o">+=</span> <span class="n">engagement_record</span><span class="p">[</span><span class="s1">&#39;total_minutes_visited&#39;</span><span class="p">]</span>
        <span class="c1">#number+=1</span>
    <span class="c1">#days[account_key]=number</span>
    <span class="n">total_minutes_by_account</span><span class="p">[</span><span class="n">account_key</span><span class="p">]</span> <span class="o">=</span> <span class="n">total_minutes</span>
<span class="c1">#print days</span>
</pre></div>


<div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>

<span class="c1"># Summarize the data about minutes spent in the classroom</span>
<span class="n">total_minutes</span> <span class="o">=</span> <span class="n">total_minutes_by_account</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>


<span class="k">print</span> <span class="s1">&#39;Mean:&#39;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">total_minutes</span><span class="p">)</span>
<span class="k">print</span> <span class="s1">&#39;Standard deviation:&#39;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">total_minutes</span><span class="p">)</span>
<span class="k">print</span> <span class="s1">&#39;Minimum:&#39;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">total_minutes</span><span class="p">)</span>
<span class="k">print</span> <span class="s1">&#39;Maximum:&#39;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">total_minutes</span><span class="p">)</span>
</pre></div>


<div class="highlight"><pre><span></span><span class="n">Mean</span><span class="o">:</span> <span class="mf">305.414718908</span>
<span class="n">Standard</span> <span class="n">deviation</span><span class="o">:</span> <span class="mf">405.91261032</span>
<span class="n">Minimum</span><span class="o">:</span> <span class="mf">0.0</span>
<span class="n">Maximum</span><span class="o">:</span> <span class="mf">3564.7332645</span>
</pre></div>


<h2>Debugging Data Analysis Code</h2>
<div class="highlight"><pre><span></span><span class="c1">#####################################</span>
<span class="c1">#                 8                 #</span>
<span class="c1">#####################################</span>

<span class="c1">## Go through a similar process as before to see if there is a problem.</span>
<span class="c1">## Locate at least one surprising piece of data, output it, and take a look at it.</span>
</pre></div>


<h2>Lessons Completed in First Week</h2>
<div class="highlight"><pre><span></span><span class="c1">#####################################</span>
<span class="c1">#                 9                 #</span>
<span class="c1">#####################################</span>

<span class="c1">## Adapt the code above to find the mean, standard deviation, minimum, and maximum for</span>
<span class="c1">## the number of lessons completed by each student during the first week. Try creating</span>
<span class="c1">## one or more functions to re-use the code above.</span>
<span class="c1"># def first_week(data):</span>
<span class="c1">#     detail_by_account = {}</span>
<span class="c1">#     for account_key, engagement_for_student in engagement_by_account.items():</span>
<span class="c1">#         detail = 0</span>
<span class="c1">#         number=0</span>
<span class="c1">#         for engagement_record in engagement_for_student:</span>
<span class="c1">#             detail += engagement_record[data]</span>
<span class="c1">#         detail_by_account[account_key] = detail</span>
<span class="k">def</span> <span class="nf">firstweek</span><span class="p">(</span><span class="n">group</span><span class="p">,</span><span class="n">data</span><span class="p">):</span>
    <span class="n">detail_of_account</span><span class="o">=</span><span class="p">{}</span>
    <span class="k">for</span> <span class="n">account_key</span><span class="p">,</span><span class="n">engagement</span> <span class="ow">in</span> <span class="n">group</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="n">detail</span><span class="o">=</span><span class="mi">0</span>
        <span class="k">for</span> <span class="n">engagement_record</span> <span class="ow">in</span> <span class="n">engagement</span><span class="p">:</span>
            <span class="n">detail</span> <span class="o">+=</span> <span class="n">engagement_record</span><span class="p">[</span><span class="n">data</span><span class="p">]</span>
        <span class="n">detail_of_account</span><span class="p">[</span><span class="n">account_key</span><span class="p">]</span><span class="o">=</span><span class="n">detail</span>
    <span class="k">return</span> <span class="n">detail_of_account</span>
<span class="n">total_lessons_by_account</span><span class="o">=</span> <span class="n">firstweek</span><span class="p">(</span><span class="n">engagement_by_account</span><span class="p">,</span><span class="s1">&#39;lessons_completed&#39;</span><span class="p">)</span>
<span class="n">total_lessons_by_account</span><span class="p">[</span><span class="s1">&#39;0&#39;</span><span class="p">]</span>
</pre></div>


<div class="highlight"><pre><span></span>1
</pre></div>


<div class="highlight"><pre><span></span><span class="n">lessons_completed</span><span class="o">=</span><span class="n">total_lessons_by_account</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="k">print</span> <span class="s1">&#39;mean=&#39;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">lessons_completed</span><span class="p">)</span>
<span class="k">print</span> <span class="s1">&#39;standard Deviation=&#39;</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">lessons_completed</span><span class="p">)</span>
<span class="k">print</span> <span class="s1">&#39;minimum=&#39;</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">lessons_completed</span><span class="p">)</span>
<span class="k">print</span> <span class="s1">&#39;maximum=&#39;</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">lessons_completed</span><span class="p">)</span>
</pre></div>


<div class="highlight"><pre><span></span>mean= 1.63216080402
standard Deviation= 3.00140182563
minimum= 0
maximum= 36
</pre></div>


<h2>Number of Visits in First Week</h2>
<div class="highlight"><pre><span></span><span class="c1">######################################</span>
<span class="c1">#                 10                 #</span>
<span class="c1">######################################</span>

<span class="c1">## Find the mean, standard deviation, minimum, and maximum for the number of</span>
<span class="c1">## days each student visits the classroom during the first week.</span>
<span class="c1"># for account_key,engagement in engagement_by_account.items():</span>
<span class="c1">#     for engagement_record in engagement:</span>
<span class="c1">#         if(engagement_record[&#39;num_courses_visited&#39;]&gt;0):</span>
<span class="c1">#             engagement_record[&#39;has_visited&#39;]=1</span>
<span class="c1">#         else:</span>
<span class="c1">#             engagement_record[&#39;has_visited&#39;]=0</span>
<span class="k">for</span> <span class="n">engagement_record</span> <span class="ow">in</span> <span class="n">paid_engagement</span><span class="p">:</span>
    <span class="k">if</span> <span class="n">engagement_record</span><span class="p">[</span><span class="s1">&#39;num_courses_visited&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">engagement_record</span><span class="p">[</span><span class="s1">&#39;has_visited&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">engagement_record</span><span class="p">[</span><span class="s1">&#39;has_visited&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">total_visits_by_account</span><span class="o">=</span><span class="n">firstweek</span><span class="p">(</span><span class="n">engagement_by_account</span><span class="p">,</span><span class="s1">&#39;has_visited&#39;</span><span class="p">)</span>
<span class="n">num_courses</span><span class="o">=</span><span class="n">total_visits_by_account</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="k">print</span> <span class="s1">&#39;mean=&#39;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">num_courses</span><span class="p">)</span>
<span class="k">print</span> <span class="s1">&#39;standard Deviation=&#39;</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">num_courses</span><span class="p">)</span>
<span class="k">print</span> <span class="s1">&#39;minimum=&#39;</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">num_courses</span><span class="p">)</span>
<span class="k">print</span> <span class="s1">&#39;maximum=&#39;</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">num_courses</span><span class="p">)</span>
</pre></div>


<div class="highlight"><pre><span></span>mean= 2.91256281407
standard Deviation= 2.22037005491
minimum= 0
maximum= 7
</pre></div>


<h2>Splitting out Passing Students</h2>
<div class="highlight"><pre><span></span><span class="c1">######################################</span>
<span class="c1">#                 11                 #</span>
<span class="c1">######################################</span>

<span class="c1">## Create two lists of engagement data for paid students in the first week.</span>
<span class="c1">## The first list should contain data for students who eventually pass the</span>
<span class="c1">## subway project, and the second list should contain data for students</span>
<span class="c1">## who do not.</span>

<span class="c1"># subway_project_lesson_keys = [&#39;746169184&#39;, &#39;3176718735&#39;]</span>

<span class="c1"># passing_engagement = set()</span>

<span class="c1"># non_passing_engagement = set()</span>
<span class="c1"># data = [1, 2, 1, 3, 3, 1, 4, 2]</span>

<span class="c1"># %matplotlib inline</span>
<span class="c1"># import matplotlib.pyplot as plt</span>
<span class="c1"># plt.hist(data)</span>
<span class="n">subway_project_lesson_keys</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;746169184&#39;</span><span class="p">,</span> <span class="s1">&#39;3176718735&#39;</span><span class="p">]</span>

<span class="n">pass_subway_project</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>

<span class="k">for</span> <span class="n">submission</span> <span class="ow">in</span> <span class="n">paid_submissions</span><span class="p">:</span>
    <span class="n">project</span> <span class="o">=</span> <span class="n">submission</span><span class="p">[</span><span class="s1">&#39;lesson_key&#39;</span><span class="p">]</span>
    <span class="n">rating</span> <span class="o">=</span> <span class="n">submission</span><span class="p">[</span><span class="s1">&#39;assigned_rating&#39;</span><span class="p">]</span>    

    <span class="k">if</span> <span class="p">((</span><span class="n">project</span> <span class="ow">in</span> <span class="n">subway_project_lesson_keys</span><span class="p">)</span> <span class="ow">and</span>
            <span class="p">(</span><span class="n">rating</span> <span class="o">==</span> <span class="s1">&#39;PASSED&#39;</span> <span class="ow">or</span> <span class="n">rating</span> <span class="o">==</span> <span class="s1">&#39;DISTINCTION&#39;</span><span class="p">)):</span>
        <span class="n">pass_subway_project</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">submission</span><span class="p">[</span><span class="s1">&#39;account_key&#39;</span><span class="p">])</span>

<span class="nb">len</span><span class="p">(</span><span class="n">pass_subway_project</span><span class="p">)</span>

<span class="n">passing_engagement</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">non_passing_engagement</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">engagement_record</span> <span class="ow">in</span> <span class="n">paid_engagement_in_first_week</span><span class="p">:</span>
    <span class="k">if</span> <span class="n">engagement_record</span><span class="p">[</span><span class="s1">&#39;account_key&#39;</span><span class="p">]</span> <span class="ow">in</span> <span class="n">pass_subway_project</span><span class="p">:</span>
        <span class="n">passing_engagement</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">engagement_record</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">non_passing_engagement</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">engagement_record</span><span class="p">)</span>

<span class="k">print</span> <span class="nb">len</span><span class="p">(</span><span class="n">passing_engagement</span><span class="p">)</span>
<span class="k">print</span> <span class="nb">len</span><span class="p">(</span><span class="n">non_passing_engagement</span><span class="p">)</span>
</pre></div>


<div class="highlight"><pre><span></span>4528
2392
</pre></div>


<div class="highlight"><pre><span></span><span class="c1">######################################</span>
<span class="c1">#                 12                 #</span>
<span class="c1">######################################</span>

<span class="c1">## Compute some metrics you&#39;re interested in and see how they differ for</span>
<span class="c1">## students who pass the subway project vs. students who don&#39;t. A good</span>
<span class="c1">## starting point would be the metrics we looked at earlier (minutes spent</span>
<span class="c1">## in the classroom, lessons completed, and days visited).</span>
<span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">defaultdict</span>

<span class="c1"># Create a dictionary of engagement grouped by student.</span>
<span class="c1"># The keys are account keys, and the values are lists of engagement records.</span>
<span class="n">pass_engagement_by_account</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">list</span><span class="p">)</span>
<span class="k">for</span> <span class="n">engagement_record</span> <span class="ow">in</span> <span class="n">passing_engagement</span><span class="p">:</span>
    <span class="n">account_key</span> <span class="o">=</span> <span class="n">engagement_record</span><span class="p">[</span><span class="s1">&#39;account_key&#39;</span><span class="p">]</span>
    <span class="n">pass_engagement_by_account</span><span class="p">[</span><span class="n">account_key</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">engagement_record</span><span class="p">)</span>

<span class="n">total_minutes</span><span class="o">=</span><span class="p">(</span><span class="n">firstweek</span><span class="p">(</span><span class="n">pass_engagement_by_account</span><span class="p">,</span><span class="s1">&#39;total_minutes_visited&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
<span class="n">lessons_completed</span><span class="o">=</span><span class="p">(</span><span class="n">firstweek</span><span class="p">(</span><span class="n">pass_engagement_by_account</span><span class="p">,</span><span class="s1">&#39;lessons_completed&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
<span class="n">has_visited</span><span class="o">=</span><span class="p">(</span><span class="n">firstweek</span><span class="p">(</span><span class="n">pass_engagement_by_account</span><span class="p">,</span><span class="s1">&#39;has_visited&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
<span class="k">def</span> <span class="nf">making_histogram</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
    <span class="o">%</span><span class="n">pylab</span> <span class="n">inline</span>
    <span class="kn">import</span> <span class="nn">seaborn</span> <span class="kn">as</span> <span class="nn">sns</span>
    <span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">as</span> <span class="nn">plt</span>
    <span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>

    <span class="c1"># Summarize the given data</span>
    <span class="k">def</span> <span class="nf">describe_data</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
        <span class="k">print</span> <span class="s1">&#39;Mean:&#39;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
        <span class="k">print</span> <span class="s1">&#39;Standard deviation:&#39;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
        <span class="k">print</span> <span class="s1">&#39;Minimum:&#39;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
        <span class="k">print</span> <span class="s1">&#39;Maximum:&#39;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">data</span><span class="p">,</span><span class="n">bins</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
    <span class="n">describe_data</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="n">making_histogram</span><span class="p">(</span><span class="n">total_minutes</span><span class="p">)</span>
</pre></div>


<div class="highlight"><pre><span></span>Populating the interactive namespace from numpy and matplotlib
Mean: 391.481722325
Standard deviation: 439.653061726
Minimum: 0.0
Maximum: 3564.7332645
</pre></div>


<p><img alt="png" src="output_40_1.png"></p>
<div class="highlight"><pre><span></span><span class="n">making_histogram</span><span class="p">(</span><span class="n">lessons_completed</span><span class="p">)</span>
</pre></div>


<div class="highlight"><pre><span></span>Populating the interactive namespace from numpy and matplotlib
Mean: 2.04327666151
Standard deviation: 3.1428602763
Minimum: 0
Maximum: 36
</pre></div>


<p><img alt="png" src="output_41_1.png"></p>
<div class="highlight"><pre><span></span><span class="n">making_histogram</span><span class="p">(</span><span class="n">has_visited</span><span class="p">)</span>
</pre></div>


<div class="highlight"><pre><span></span>Populating the interactive namespace from numpy and matplotlib
Mean: 3.42967542504
Standard deviation: 2.21298340866
Minimum: 0
Maximum: 7
</pre></div>


<p><img alt="png" src="output_42_1.png"></p>
<h2>Comparing the Two Student Groups</h2>
<div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">defaultdict</span>

<span class="c1"># Create a dictionary of engagement grouped by student.</span>
<span class="c1"># The keys are account keys, and the values are lists of engagement records.</span>
<span class="n">nonpass_engagement_by_account</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">list</span><span class="p">)</span>
<span class="k">for</span> <span class="n">engagement_record</span> <span class="ow">in</span> <span class="n">non_passing_engagement</span><span class="p">:</span>
    <span class="n">account_key</span> <span class="o">=</span> <span class="n">engagement_record</span><span class="p">[</span><span class="s1">&#39;account_key&#39;</span><span class="p">]</span>
    <span class="n">nonpass_engagement_by_account</span><span class="p">[</span><span class="n">account_key</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">engagement_record</span><span class="p">)</span>

<span class="n">total_minutes</span><span class="o">=</span><span class="p">(</span><span class="n">firstweek</span><span class="p">(</span><span class="n">nonpass_engagement_by_account</span><span class="p">,</span><span class="s1">&#39;total_minutes_visited&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
<span class="n">lessons_completed</span><span class="o">=</span><span class="p">(</span><span class="n">firstweek</span><span class="p">(</span><span class="n">nonpass_engagement_by_account</span><span class="p">,</span><span class="s1">&#39;lessons_completed&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
<span class="n">has_visited</span><span class="o">=</span><span class="p">(</span><span class="n">firstweek</span><span class="p">(</span><span class="n">nonpass_engagement_by_account</span><span class="p">,</span><span class="s1">&#39;has_visited&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
<span class="k">def</span> <span class="nf">making_histogram</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
    <span class="o">%</span><span class="n">pylab</span> <span class="n">inline</span>

    <span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">as</span> <span class="nn">plt</span>
    <span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>

    <span class="c1"># Summarize the given data</span>
    <span class="k">def</span> <span class="nf">describe_data</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
        <span class="k">print</span> <span class="s1">&#39;Mean:&#39;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
        <span class="k">print</span> <span class="s1">&#39;Standard deviation:&#39;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
        <span class="k">print</span> <span class="s1">&#39;Minimum:&#39;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
        <span class="k">print</span> <span class="s1">&#39;Maximum:&#39;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">data</span><span class="p">,</span><span class="n">bins</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
    <span class="n">describe_data</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="n">making_histogram</span><span class="p">(</span><span class="n">total_minutes</span><span class="p">)</span>
</pre></div>


<div class="highlight"><pre><span></span>Populating the interactive namespace from numpy and matplotlib
Mean: 145.399341866
Standard deviation: 268.97150373
Minimum: 0.0
Maximum: 1768.52274933
</pre></div>


<p><img alt="png" src="output_45_1.png"></p>
<h2>Making Histograms</h2>
<div class="highlight"><pre><span></span><span class="c1">######################################</span>
<span class="c1">#                 13                 #</span>
<span class="c1">######################################</span>

<span class="c1">## Make histograms of the three metrics we looked at earlier for both</span>
<span class="c1">## students who passed the subway project and students who didn&#39;t. You</span>
<span class="c1">## might also want to make histograms of any other metrics you examined.</span>
<span class="n">making_histogram</span><span class="p">(</span><span class="n">lessons_completed</span><span class="p">)</span>
</pre></div>


<div class="highlight"><pre><span></span>Populating the interactive namespace from numpy and matplotlib
Mean: 0.867816091954
Standard deviation: 2.54833703959
Minimum: 0
Maximum: 27
</pre></div>


<p><img alt="png" src="output_47_1.png"></p>
<div class="highlight"><pre><span></span><span class="n">making_histogram</span><span class="p">(</span><span class="n">has_visited</span><span class="p">)</span>
</pre></div>


<div class="highlight"><pre><span></span>Populating the interactive namespace from numpy and matplotlib
Mean: 1.95114942529
Standard deviation: 1.88929952676
Minimum: 0
Maximum: 7
</pre></div>


<p><img alt="png" src="output_48_1.png"></p>
<h2>Improving Plots and Sharing Findings</h2>
<div class="highlight"><pre><span></span><span class="c1">######################################</span>
<span class="c1">#                 14                 #</span>
<span class="c1">######################################</span>

<span class="c1">## Make a more polished version of at least one of your visualizations</span>
<span class="c1">## from earlier. Try importing the seaborn library to make the visualization</span>
<span class="c1">## look better, adding axis labels and a title, and changing one or more</span>
<span class="c1">## arguments to the hist() function.</span>
</pre></div>


<div class="highlight"><pre><span></span>
</pre></div>


<div class="highlight"><pre><span></span>
</pre></div>
    </div><!-- /.entry-content -->

  </article>
</section>
        <section id="extras" class="body">
                <div class="blogroll">
                        <h2>links</h2>
                        <ul>
                            <li><a href="http://getpelican.com/">Pelican</a></li>
                            <li><a href="http://python.org/">Python.org</a></li>
                            <li><a href="http://jinja.pocoo.org/">Jinja2</a></li>
                            <li><a href="#">You can modify those links in your config file</a></li>
                        </ul>
                </div><!-- /.blogroll -->
                <div class="social">
                        <h2>social</h2>
                        <ul>

                            <li><a href="#">You can add links in your config file</a></li>
                            <li><a href="#">Another social link</a></li>
                        </ul>
                </div><!-- /.social -->
        </section><!-- /#extras -->

        <footer id="contentinfo" class="body">
                <address id="about" class="vcard body">
                Proudly powered by <a href="http://getpelican.com/">Pelican</a>, which takes great advantage of <a href="http://python.org">Python</a>.
                </address><!-- /#about -->

                <p>The theme is by <a href="http://coding.smashingmagazine.com/2009/08/04/designing-a-html-5-layout-from-scratch/">Smashing Magazine</a>, thanks!</p>
        </footer><!-- /#contentinfo -->

</body>
</html>